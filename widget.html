<!DOCTYPE html>
<html>
    <head>
        <script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
    </head>
    <body>
        <div id="main">
            <h3>My Widget</h3>
            <p>Enter values in the fields below:</p>
            <label for="userInput1">Field 1:</label>
            <input type="text" id="userInput1" placeholder="Enter first value">
            <br><br>
            <label for="userInput2">Field 2:</label>
            <input type="text" id="userInput2" placeholder="Enter second value">
        </div>
        <script type="text/javascript">
            // Function to locate and log the value of the hidden input field
            function findAndLogHiddenFieldValue(fieldId) {
                // Dynamically construct the selector based on the `field1` value
                const hiddenFieldSelector = `input[id="${fieldId}"]`;
                const hiddenField = document.querySelector(hiddenFieldSelector);

                if (hiddenField) {
                    console.log(`Value of the hidden field with ID "${fieldId}":`, hiddenField.value);
                } else {
                    console.warn(`Hidden field with ID "${fieldId}" not found.`);
                }
            }

            // Always subscribe to the ready event and implement widget-related code inside the callback function
            JFCustomWidget.subscribe("ready", function() {
                // Log all widget settings to the console
                const settings = JFCustomWidget.getWidgetSettings();
                console.log("Widget settings:", settings);

                // Fetch the value of field1 from the settings
                const field1 = settings.field1;
                if (field1) {
                    console.log(`Looking for hidden field with ID: ${field1}`);
                    // Locate and log the value of the hidden input field
                    findAndLogHiddenFieldValue(field1);
                } else {
                    console.error("field1 is not defined in the widget settings.");
                }

                // Subscribe to the form submit event
                JFCustomWidget.subscribe("submit", function() {
                    // Get values from both input fields
                    const value1 = document.getElementById("userInput1").value;
                    const value2 = document.getElementById("userInput2").value;

                    // Prepare the message to send to JotForm
                    const msg = {
                        valid: true, // Mark as valid
                        value: {
                            field1: value1,
                            field2: value2
                        }
                    };

                    // Log the submitted data for debugging
                    console.log("Submitting data:", msg);

                    // Send the values to JotForm
                    JFCustomWidget.sendSubmit(msg);
                });
            });
        </script>
    </body>
</html>