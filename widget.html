<!DOCTYPE html>
<html>
    <head>
        <script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
    </head>
    <body>
        <div id="main">
            <h3>My Widget</h3>
            <p>Fetching values from widget inputs...</p>
        </div>
        <script type="text/javascript">
            // Function to log all hidden input values from the widget
            function logHiddenFieldValues() {
                // Select all hidden inputs within the widget-inputs-wrapper div
                const hiddenInputs = document.querySelectorAll('.widget-inputs-wrapper input[type="hidden"]');

                if (hiddenInputs.length > 0) {
                    console.log("Hidden field values:");
                    hiddenInputs.forEach((input) => {
                        console.log(`Name: ${input.name}, Value: ${input.value}`);
                    });
                } else {
                    console.warn("No hidden inputs found in the widget-inputs-wrapper.");
                }
            }

            // Always subscribe to the ready event
            JFCustomWidget.subscribe("ready", function () {
                console.log("Widget is ready. Fetching hidden field values...");
                logHiddenFieldValues();

                // Subscribe to the form submit event
                JFCustomWidget.subscribe("submit", function () {
                    // Optionally, re-fetch the values on submission
                    console.log("Form is being submitted. Re-fetching hidden field values...");
                    logHiddenFieldValues();

                    // Send dummy data as a placeholder (replace or extend as needed)
                    const msg = {
                        valid: true,
                        value: { exampleKey: "exampleValue" },
                    };
                    JFCustomWidget.sendSubmit(msg);
                });
            });
        </script>
    </body>
</html>