<!DOCTYPE html>
<html>
    <head>
        <title>Auto Submit Widget</title>
        <!-- Load JotForm's Custom Widget SDK -->
        <script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
    </head>
    <body>
        <div id="widget-container">
            <h3>The form will auto-submit shortly.....</h3>
        </div>
        <script type="text/javascript">
            // Initialize the widget when ready
            JFCustomWidget.subscribe("ready", function () {
                console.log("Widget SDK is ready!");

                // Notify the parent form that the widget has initialized
                JFCustomWidget.sendData({
                    initialized: true
                });
                console.log("Initialization data sent to JotForm.");

                // Trigger auto-submit after a delay
                setTimeout(function () {
                    console.log("Attempting to auto-submit the form...");
                    try {
                        // Send submission data to the parent form
                        JFCustomWidget.sendSubmit({
                            valid: true, // Mark the widget as valid
                            value: "Auto-submitted by the widget" // Placeholder value
                        });
                        console.log("Form submission triggered successfully.");
                    } catch (error) {
                        console.error("Error during form submission:", error);
                    }
                }, 3000); // 3-second delay
            });

            // Log any subscription errors for debugging
            JFCustomWidget.subscribe("error", function (error) {
                console.error("Widget SDK error:", error);
            });
        </script>
    </body>
</html>
