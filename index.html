<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JotForm Widget URL Detection</title>

    <!-- Example Canonical Link (if available in the deployed environment) -->
    <link rel="canonical" href="https://form.jotform.com/example">
</head>

<body>
    <script>
        function detectUrl() {
            let detectedUrls = [];
            let finalUrl = null;

            try {
                // Attempt 1: <link rel="canonical">
                const canonicalTag = document.querySelector('link[rel="canonical"]');
                if (canonicalTag) {
                    const canonicalUrl = canonicalTag.href;
                    detectedUrls.push("[Attempt 1: Canonical Tag] URL:", canonicalUrl);
                    finalUrl = canonicalUrl;
                } else {
                    detectedUrls.push("[Attempt 1: Canonical Tag] No canonical tag found.");
                }
            } catch (error) {
                detectedUrls.push("[Attempt 1: Canonical Tag] Error reading canonical tag:", error);
            }

            try {
                // Attempt 2: document.location.href
                const locationHref = document.location.href;
                detectedUrls.push("[Attempt 2: document.location.href] URL:", locationHref);
                if (!finalUrl) finalUrl = locationHref;
            } catch (error) {
                detectedUrls.push("[Attempt 2: document.location.href] Error:", error);
            }

            try {
                // Attempt 3: document.URL
                const documentUrl = document.URL;
                detectedUrls.push("[Attempt 3: document.URL] URL:", documentUrl);
                if (!finalUrl) finalUrl = documentUrl;
            } catch (error) {
                detectedUrls.push("[Attempt 3: document.URL] Error:", error);
            }

            try {
                // Attempt 4: window.location.href
                const windowHref = window.location.href;
                detectedUrls.push("[Attempt 4: window.location.href] URL:", windowHref);
                if (!finalUrl) finalUrl = windowHref;
            } catch (error) {
                detectedUrls.push("[Attempt 4: window.location.href] Error:", error);
            }

            // Log all attempts
            console.log("All URL Detection Attempts:", detectedUrls);

            // Log final detected URL
            if (finalUrl) {
                console.log("Final Detected URL:", finalUrl);
            } else {
                console.error("Failed to detect URL.");
            }

            return finalUrl;
        }

        // Run URL detection and log the result
        const finalDetectedUrl = detectUrl();
    </script>
</body>

</html>